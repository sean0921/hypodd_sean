1.  Subroutine direct1 does not work for sources in the shallowest
layer.  Before the line:

c     Find the fastest layer, lmax, above and including jl

insert the following:

        if (jl .eq. 1) then
c          Focus in surface layer
           r = hypot(depth, delta)
           tdir = r/v(1)
           u = delta/r
           x = delta
           return
        endif

(This also requires the function hypot, to compute sqrt(a*a + b*b) stably.
A suitable version is given in the file hypot_.c, which is an interface
into the math library function.)

2.  Subroutine getinp sets the value of the zeroth element of the vector
aiter, although this vector has no such element.  In both the main program
and in subroutine getinp, change the declaration:

        integer         aiter(10)

to read:

        integer         aiter(0:10)

3.  Subroutine dtres declares the arguments tmp_ttp and tmp_tts to have
constant column dimensions of MAXSTA, although this is something a
subroutine cannot, in principle, know.  Add an argument by changing the
line:

        subroutine dtres(log, ndt, nsrc,
to:
        subroutine dtres(log, ndt, stdim, nsrc,

and adding the declaration:

        integer         stdim           ! Column dimenson of arrays tmp_tt[ps]

Also, change the declarations:

        real            tmp_ttp(MAXSTA,*)
        real            tmp_tts(MAXSTA,*)
to:
        real            tmp_ttp(stdim,*)
        real            tmp_tts(stdim,*)

In the main program, change the line:
        call dtres(log,ndt,nsrc,
to read:
        call dtres(log,ndt,MAXSTA,nsrc,

4.  Several write statements have extra commas.  In the main program,
change the statement:

      write(log,'("  mean centroid shift in x,y,z,t [m,ms] (change): ",/
       & f7.1,f7.1,f7.1,f7.1)'),xav,yav,zav,tav
to read:
      write(log,'("  mean centroid shift in x,y,z,t [m,ms] (change): ",/
       & f7.1,f7.1,f7.1,f7.1)') xav,yav,zav,tav

In subroutine skip, change:
        write(log,'("# obs = ",i9," (",f5.1,"%)")'),
       & ndt,(ndt*100.0/ndtold)
to read:
        write(log,'("# obs = ",i9," (",f5.1,"%)")')
       &        ndt,(ndt*100.0/ndtold)

and change:
          write(log,'("# obs cc = ",i9," (",f5.1,"%)")'),
to read:
          write(log,'("# obs cc = ",i9," (",f5.1,"%)")')

and change:
          write(log,'("# obs ct = ",i9," (",f5.1,"%)")'),
to read:
          write(log,'("# obs ct = ",i9," (",f5.1,"%)")')

and change:
        write(log,'("# events = ",i9)'),nev
to read:
        write(log,'("# events = ",i9)') nev

and change:
        write(log,'("# stations = ",i9)'),nsta
to read:
        write(log,'("# stations = ",i9)') nsta

5.  In subroutine indexxi, the local variable q is declared to be real,
and therefore does not have the precision required for storing integer
values.  Change the declaration:

        real    q
to read:
        integer q

5.  In subroutine redist, the local variables lat and lon are declared
real, but should be integer.  Change the declaration:

        real    lat, lon
to read:
        integer lat, lon
 
6.  In subroutine sorti, the argument vector ia is declared to be real,
but should be integer.  Change the Declaration:

        real ia(n)
to read:
        integer ia(n)

